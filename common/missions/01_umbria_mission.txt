umbria_mission_01 = {
    header = "mssion_gaul"
    icon = cde_gallic_tribe_negotiation

    repeatable = no
    chance = 1000

    potential = {
        NOT = { has_variable = mission_cooldown_var }
        is_subject = no
        has_civil_war = no
        OR = {
            primary_culture = umbrian
            tag = UMB
        }
    }
    ai_chance = 0

    abort = {
        ai_mission_back_out_trigger = yes
    }
    on_start = {
    }
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }
    on_completion = {
        complete_mission_effect = yes
    }

    umbria_mission_task_1 = { # Deal with the etruscans - triggers event that either gives variable 'umb_seeking_friendly_relations_with_etr' or 'umb_seeking_to_destroy_etr'
        icon = "task_battle"

        allow = {
            c:ETR = {
                exists = yes
                OR = {
                    opinion = {
                        target = ROOT
                        value >= 40
                    }
                    opinion = {
                        target = ROOT
                        value <= -40
                    }
                }
            }
        }

        highlight = {
            scope:province = {
                owner = c:ETR
            }
        }

        on_completion = {
            trigger_event = { id = me_umbria.1 }
        }
    }

    umbria_mission_task_2 = { # Etruscan Allies
        icon = "task_battle"
        
        requires = { umbria_mission_task_1 }
        prevented_by = { umbria_mission_task_5 }

        allow = {
            custom_tooltip = {
                text = umbria_mission_task_2_requirement_tt_1
                root.country = {
                    has_variable = umb_seeking_friendly_relations_with_etr            
                }
            }
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.2 }
        }
    }

    umbria_mission_task_3 = { # Etruscan Trade Links
        icon = "task_battle"
        
        requires = { umbria_mission_task_2 }
        prevented_by = { umbria_mission_task_5 }

        allow = {
            imports_from = c:ETR
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.3 }
        }

        bypass = {
            has_completed_mission_task = umbria_mission_task_5
        }
    }

    umbria_mission_task_4 = { # Assistance from Etruria - can call the Etruscans into your war with Rome
        icon = "task_battle"
        
        requires = { umbria_mission_task_2 }
        prevented_by = { umbria_mission_task_5 }

        allow = {
            war_with = c:ROM
            c:ETR = {
                NOT = {
                    war_with = c:ROM
                }
            }
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.4 }
        }
    }
    
    umbria_mission_task_5 = { # Push back Etruria - aggressive path - conquer the borderlands of etruria
        icon = "task_battle"
        
        requires = { umbria_mission_task_1 }
        prevented_by = { umbria_mission_task_2 }

        allow = {
            custom_tooltip = {
                text = umbria_mission_task_5_requirement_tt_1
                root.country = {
                    has_variable = umb_seeking_to_destroy_etr            
                }
            }
            p:131 = {
                owned_or_subject_owned = root
            }
            p:140 = {
                owned_or_subject_owned = root
            }
            p:139 = {
                owned_or_subject_owned = root
            }
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.5 }
        }
    }

    umbria_mission_task_6 = { # The Etruscan Cities - Conquer most of Etruria's cities
        icon = "task_battle"
        
        requires = { umbria_mission_task_5 }
        prevented_by = { umbria_mission_task_2 }

        allow = {
            custom_tooltip = {
                text = umbria_mission_task_6_requirement_tt_1
                any_owned_province = {
                    count >= 10
                    has_city_status = yes
                    OR = {
                        is_in_area = north_etruria_area
                        is_in_area = south_etruria_area
                        is_in_area = pisae_area
                    }
                }
            }
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.6 }
        }

        bypass = {
            has_completed_mission_task = umbria_mission_task_2
        }
    }

    umbria_mission_task_7 = { # The Fate of Etruria - Conquer the rest of Etruria and decide whether or not to avenge their past destruction of Umbrian settlements (300 cities, according to the greeks)
        icon = "task_battle"
        
        requires = { umbria_mission_task_5 }
        prevented_by = { umbria_mission_task_2 }

        allow = {
            area:north_etruria_area = {
                any_area_province = {
                    count = all
                    OR = {
                        owned_or_subject_owned = root
                        has_owner = no
                    }
                }
            }
            area:south_etruria_area = {
                any_area_province = {
                    count = all
                    OR = {
                        owned_or_subject_owned = root
                        has_owner = no
                    }
                }
            }
            area:pisae_area = {
                any_area_province = {
                    count = all
                    OR = {
                        owned_or_subject_owned = root
                        has_owner = no
                    }
                }
            }
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.7 }
        }

    }

    umbria_mission_task_8 = { # Beyond the Tyrrenian Sea
        icon = "task_battle"
        
        requires = { umbria_mission_task_6 umbria_mission_task_3 }

        allow = {
        }

        highlight = {
        }

        on_completion = {# Trade links with sardinians / west mediterranian greek colonies?
            trigger_event = { id = me_umbria.8 }
        }

    }

    umbria_mission_task_9 = { # The Latin Threat - prepare for war with Rome
        icon = "task_battle"

        allow = {
            manpower_percentage = 0.9
            c:ROM = {
                opinion = {
                    target = ROOT
                    value <= 0
                }
            }
            max_manpower >= 3000
        }

        highlight = {
            scope:province = {
                owner = c:ROM
            }
        }

        on_completion = { #event to gain Nequinum (a historical Umbrian settlement) id 23, from the Sabines, Gain cb on Rome - in event you either gain it from them, and they may become a feudatory, or you go to war with the territory occupied.
            trigger_event = { id = me_umbria.9 }
        }

    }

    umbria_mission_task_10 = { # Subvert Rome's Allies - Take Rome's Feudatories as your own
        icon = "task_battle"

        requires = { umbria_mission_task_9 }

        allow = { #Be at war with rome and have gained at least 25? warscore
            war_with = c:ROM
            custom_tooltip = {
                text = umbria_mission_task_10_requirement_tt_1
                AND = {
                    war_with = c:ROM
                    any_current_war = { #need to figure out how to get working
                        any_war_participant = { THIS = ROOT }
                        any_war_participant = { THIS = c:ROM }
                        war_score = {
                            target = ROOT
                            value >= 25
                        }
                    }    
                }
            }
        }

        highlight = {
           scope:province = {
               owned_or_subject_owned = c:ROM
           }
        }

        on_completion = {
            trigger_event = { id = me_umbria.10 }
        }

    }

    umbria_mission_task_11 = { # Conquer Latium
        icon = "task_battle"

        requires = { umbria_mission_task_10 }

        allow = {   
            custom_tooltip ={
                text = umbria_mission_task_11_requirement_tt_1
                area:roma_area = {
                    any_area_province = {
                        count = all
                        OR = {
                            owned_or_subject_owned = yes
                            has_owner = no
                        }
                    }
                }
                p:18 = {
                    owned_or_subject_owned = root
                }
            }
        }

        highlight = {
            scope:province = {
                NOT = {
                    owned_or_subject_owned = ROOT
                }
                OR = {
                    is_in_area = roma_area
                    province_id = 18
                }
            }
        }

        on_completion = { #Claims on Capua
            trigger_event = { id = me_umbria.11 }
        }

    }

    umbria_mission_task_12 = { # Into Capua
        icon = "task_battle"

        requires = { umbria_mission_task_11 }

        allow = {
            custom_tooltip ={
                text = umbria_mission_task_11_requirement_tt_1
                p:7 = {
                    owned_or_subject_owned = root
                }
                p:6 = {
                    owned_or_subject_owned = root
                }
                p:8 = {
                    owned_or_subject_owned = root
                }
                p:31 = {
                    owned_or_subject_owned = root
                }
                p:40 = {
                    owned_or_subject_owned = root
                }
                p:1713 = {
                    owned_or_subject_owned = root
                }
                p:9 = {
                    owned_or_subject_owned = root
                }
            } 
        }

        highlight = {
            scope:province = {
                AND = {
                    NOT = {
                        owned_or_subject_owned = root
                    }
                    OR = {
                        province_id = 7
                        province_id = 6
                        province_id = 8
                        province_id = 31
                        province_id = 40
                        province_id = 1713
                        province_id = 9
                    }
                }
            }
        }

        on_completion = {
            trigger_event = { id = me_umbria.12 }
        }

    }

    umbria_mission_task_13 = { # Picene Alliance
        icon = "task_battle"

        requires = { umbria_mission_task_9 }

        allow = { #Picentia needs a high opinion of you
                c:PIE = {
                    opinion = {
                        target = root
                        value >= 50
                    }
                }
            alliance_with = c:PIE
        }

        highlight = {
            scope:province = {
                owner = c:PIE
            }
        }

        on_completion = {
            trigger_event = { id = me_umbria.13 }
        }

    }

    umbria_mission_task_14 = { # Welcome Picentia to the Federation
        icon = "task_battle"

        requires = { umbria_mission_task_13 }

        allow = {#Picentia has high opinion of you, and you have the size and strength to protect them
                c:PIE = {
                    opinion = {
                        target = root
                        value >= 100
                    }
                    num_of_cities <= 5
                }
            num_of_cities >= 25
            manpower >= 3000
        }

        highlight = {
            scope:province = {
                owner = c:PIE
            }
        }

        on_completion = {
            trigger_event = { id = me_umbria.14 }
        }

    }

    umbria_mission_task_15 = { # Picene Trade
        icon = "task_battle"

        requires = { umbria_mission_task_14 }

        allow = {
            imports_from = c:PIE         
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.15 }
        }

    }

    umbria_mission_task_16 = { # Sieze Ancona
        icon = "task_battle"

        requires = { umbria_mission_task_14 }

        allow = { 

        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.16 }
        }

    }

    umbria_mission_task_17 = { # Security in the North - Triggers and event where you select whether to ally the Celts (allows you to try to vassalize some of them), or conquer them. This will affect the requirements and effects of the next two tasks.
        icon = "task_battle"

        allow = { 
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.17 }
        }

    }

    umbria_mission_task_18 = { # Secure the Northern Border - Vassalize or conquer the Celtic tribe to your immediate north (generally the sennones)
        icon = "task_battle"

        requires = { umbria_mission_task_17 }

        allow = { 
            
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.18 }
        }

    }

    umbria_mission_task_19 = { # Towards the Padan River - Conquer or Vassalize the Celtic tribes inhabiting the estuary of the Padan, and the area of Aemilia
        icon = "task_battle"

        requires = { umbria_mission_task_18 }

        allow = { 
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.19 }
        }

    }

    umbria_mission_task_20 = { # Rival the Samnites - Insult Samnium or have them hate you, and prepare for war against them - will trigger an event giving them an ultimatum to shrink their borders to you, as you absorb most of the Samnite tribes (also vassalizing what's left), or you declare war on them.
        icon = "task_battle"

        requires = { umbria_mission_task_19 umbria_mission_task_12 umbria_mission_task_8 }

        allow = { 
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.20 }
        }

    }

    umbria_mission_task_21 = { # Hegemon of Italia - Having consolidated all claimed lands in Italy, and having high stab and provincial loyalty, you declare an Umbrian Federation 

        requires = { umbria_mission_task_20 }

        allow = { 
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.21 }
        }

    }

    umbria_mission_task_22 = { # Umbrian Metalworking
        icon = "task_battle"

        requires = { umbria_mission_task_21 }

        allow = { 
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.22 }
        }

    }

    umbria_mission_task_23 = { # The Mints of Iguvium
        icon = "task_battle"

        requires = { umbria_mission_task_22 }

        allow = { 
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.23 }
        }

    }

    umbria_mission_task_24 = { # Rural Expansion - results in buffs to rural settlements across the Appinines
        icon = "task_battle"

        requires = { umbria_mission_task_21 }

        allow = { 
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.24 }
        }

    }

    umbria_mission_task_25 = { # Seek Alliances with the Greeks - The Greek states of magna Graecia either become feudatories, or you get claims on them.

        icon = "task_battle"

        requires = { umbria_mission_task_21 }

        allow = { 
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.25 }
        }

    }

    umbria_mission_task_26 = { # Invite Lucania into the Federation

        icon = "task_battle"

        requires = { umbria_mission_task_21 }

        allow = { 
        }

        highlight = {
        }

        on_completion = {
            trigger_event = { id = me_umbria.26 }
        }

    }

    umbria_mission_task_27 = { # Expand Across Brutium

        icon = "task_battle"

        requires = { umbria_mission_task_26 }

        allow = { 
        }

        highlight = {
        }

        on_completion = { #Claims over Syracuse?
            trigger_event = { id = me_umbria.27 }
        }

    }
}