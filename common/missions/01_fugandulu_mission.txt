01_fugandulu = {
    header = "indian_mission_header"
    icon = "india_3"

    repeatable = no
    chance = 1000

    potential = {
        tag = FGD
        NOT = { has_variable = mission_cooldown_var }
    }

    abort = {}
    on_start = {
        start_mission_ai_effect = yes
    }
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }
    on_completion = {
        add_3_free_province_investments = yes
    }

    01_fugandulu_task_1 = { #Province of Piu
        icon = "task_battle"
        duration = 30

        highlight = {
			scope:province = {
                OR = {
                    is_in_area = pyu_area
                }
            }
	    }

        allow = {
            political_influence >= 15 
        }
        on_completion = {
            add_political_influence = -15
            area:pyu_area = {
				add_provincial_claim_effect = yes
            }
            trigger_event = me_fugandulu.1
        }
    }

    01_fugandulu_task_2 = { #Strengthened Security
        icon = "task_diplomatic"
        allow = {
            custom_tooltip = {
				text = fugandulu_1_ally_tt
				any_country = {
					count >= 1
					OR = {
						is_subject_of = root
						alliance_with = root
					}
				}
			}
        }
        on_completion = {
            add_political_influence = 10
            current_ruler = {
                add_finesse = 1
            }
            trigger_event = me_fugandulu.2
        }
    }

    01_fugandulu_task_3 = { #Kuji'i Nat Of Taledan
        icon = "task_religion"
        allow = {
            has_deity_in_pantheon = deity:omen_kujii
        }
        on_completion = {
            add_country_modifier = {
                name = blessing_of_kijii_fugandulu_mod
                duration = 3650
            }
            trigger_event = me_fugandulu.3
        }
    }

    01_fugandulu_task_4 = { #
        icon = "task_conquest"
        requires = { 01_fugandulu_task_1 01_fugandulu_task_2 01_fugandulu_task_3 } 
        duration = 60 

        highlight = {
			scope:province = {
                OR = {
                    is_in_area = pyu_area
                }
            }
	    }

        allow = {
            political_influence >= 30 
            owns_or_subject_owns_area = pyu_area
            diplomatic_stance = warmongering_stance
        }

        on_completion = {
            add_political_influence = -30
            area:shan_area = {
				add_provincial_claim_effect = yes
            }
            area:pubu_area = {
				add_provincial_claim_effect = yes
            }
            area:arakan_area = {
				add_provincial_claim_effect = yes
            }
            trigger_event = me_fugandulu.4
        }
    }

    01_fugandulu_task_5 = { # Kuji'i's Fortress
        icon = "task_athena"
        requires = { 01_fugandulu_task_3 }

        allow = {
            has_this_omen = deity:omen_kujii
            invention = global_defensive_inv_1
            military_experience >= 20 
        }

         
        on_completion = {
            capital_scope = {
                add_permanent_province_modifier = {
                    name = kijii_fort_fugandulu_mod
                    duration = -1
                }
            }
            trigger_event = me_fugandulu.5
            show_as_tooltip = {

            }
        }
    }
    01_fugandulu_task_6 = { #Farming Fugandulu
        icon = "task_calm"
        requires = { 01_fugandulu_task_7 }

        highlight = {
            scope:province = {
                owner = root
            }
        }

        allow = {
            invention = global_tax_modifier_inv_1
            custom_tooltip = {
                text = fugandulu_has_bureaucracy_war_tt
                has_military_bonus = mauryan_mauryas_path_end_bonus
            }
            custom_tooltip = {
                text = fugandulu_needs_two_farms_tt
                any_owned_province = {
                    count >= 2
                    has_province_rank = settlement
                    num_of_basic_settlement_infratructure_building = 1
                }
            }
        }
         
        on_completion = {
            add_centralization = 10
            current_ruler = {
                add_popularity = 10
            }
            capital_scope = {
                if = {
                    limit = {
                        has_city_status = no
                    }
                    found_city_effect = yes
                }
                if = {
                	limit = {
                		free_building_slots >= 3
						can_build_building = foundry_building
                	}
                	add_building_level = foundry_building
                }
                else_if = {
                	limit = {
                		free_building_slots = 2
						can_build_building = academy_building
                	}
                	add_building_level = academy_building
                }
                else_if = {
                	limit = {
                		free_building_slots = 1
						can_build_building = academy_building
                	}
					add_building_level = academy_building
                }
			}
            trigger_event = me_fugandulu.6
            
        }
    }
    01_fugandulu_task_7 = {
        icon = "task_economical"
        requires = { 01_fugandulu_task_1 } 

        highlight = {
			scope:province = {
				province_id = 8773				
			}
		}


        allow = {
            owns_or_subject_owns = 8773
			hidden:p:8773 = {
				has_building = slave_mine_building
				has_no_ongoing_construction = yes
			}
        }
        
        on_completion = {
            trigger_event = me_fugandulu.7
            add_1_free_province_investments = yes
			p:8773 = {
				add_permanent_province_modifier = {
					name = fugandulu_slave_mine_mod
                    duration = -1
				}
			}
            change_law = coin_minting_law
        }
    }
    01_fugandulu_task_8 = { #Master Of Puppets
        icon = "task_political"
        requires = { 01_fugandulu_task_2 } 

        allow = {
            custom_tooltip = {
				text = fugandulu_3_ally_tt
				any_country = {
					count >= 3
					is_subject_of = root
				}
			}
        }
        
        on_completion = {
            current_ruler = {
                force_add_trait = tactician
                add_martial = 1
            }
            trigger_event = me_fugandulu.8
            show_as_tooltip = {

            }
        }
    }
    01_fugandulu_task_9 = { # Iron Arrows And Leather Shields
        icon = "task_political"
        requires = { 01_fugandulu_task_5 01_fugandulu_task_7 } 

        highlight = {
            scope:province = {
                owner = root
                is_capital = yes
            }
        }

        allow = {
            treasury >= 50
			custom_tooltip = {
                text = fugandulu_iron_arrows_tt
                capital_scope.state = {
                    trade_good_surplus = {
                        target = iron
                        value >= 2
                    }
                    trade_good_surplus = {
                        target = leather
                        value >= 2
                    }
                }
            }
        }
        
        on_completion = {
            add_treasury = -50
            add_country_modifier = {
                name = fugandulu_archers_light_infantry_mod
                duration = -1
            }
            trigger_event = me_fugandulu.9
        }
    }
    01_fugandulu_task_10 = { #Settling Shan
        icon = "task_expansion"
        requires = { 01_fugandulu_task_4 }

        highlight = {
			scope:province = {
                OR = {
                    is_in_area = shan_area
                }
            }
	    }

        allow = {
            owns_percent_of_area = {
                PROVINCE = "p:8806"
                PERCENT = "0.5"
            }
        }
        
        on_completion = {
            trigger_event = me_fugandulu.10
            add_country_modifier = {
                name = fugandulu_cheaper_slaves_cost 
                duration = 3650
            }
            capital_scope = {
                create_state_pop = tribesmen
                create_state_pop = tribesmen
                create_state_pop = freemen
                create_state_pop = citizen
            }
        }
    }
    01_fugandulu_task_11 = { # The Golden Road
        icon = "task_economical"
        requires = { 01_fugandulu_task_10 }

        highlight = {
			scope:province = {
                OR = {
                    is_in_area = arakan_area
                }
            }
	    }

        allow = {
            owns_or_subject_owns_area = arakan_area
            custom_tooltip = {
                text = pillars_herc_tt
                    invention = pirate_spawn_chance_inv_1
            } 
            hidden:p:8770 = {
                has_building = fortress_building
            } 
            hidden:p:8769 = {
                has_building = port_building
            } 
            has_law = absolute_authority
        }
        
        on_completion = {
            add_1_free_province_investments = yes
            add_innovation = 2
            p:8769 = { add_road_towards = p:8770 }
            p:8770 = { add_road_towards = p:8771 }
            add_centralization = 5
            random_owned_province = {
				limit = {
					num_of_port_building > 0 
				}
				owner = {
					create_unit = {
						navy = yes
						location = prev.prev
						add_subunit = liburnian
				        add_subunit = liburnian
				        add_subunit = liburnian
                        add_subunit = liburnian
				        add_subunit = liburnian
					}
				}
			}
            trigger_event = me_fugandulu.11
        }
    }
    01_fugandulu_task_12 = { # Fields of Glory
        icon = "task_happiness"
        requires = { 01_fugandulu_task_9 01_fugandulu_task_10 }
        final = yes

        highlight = {
            scope:province = {
                is_in_region = burma_region
            }
        }

        allow = {
            owns_percent_of_region = {
                PROVINCE = "p:8771" # burma_region
                PERCENT = "0.75"
            }
            custom_tooltip = {
                text = you_need_to_form_pugramadvara_tt
                tag =PRU
            }
            custom_tooltip = {
                text = fugandulu_fifty_percent_natic_tt
                region:burma_region = {
                    any_region_province = {
                        percent >= 0.5
                        dominant_province_religion = root.religion
                    }
                } 
            }
            capital_scope = {
                civilization_value >= 20
            }
        }
        
        on_completion = {
            current_ruler = {
                add_popularity = 25
                force_add_trait = founder
            }
            add_political_influence = 50
            add_centralization = 25
            trigger_event = me_fugandulu.12
            show_as_tooltip = {

            }
        }
    }
    01_fugandulu_task_13 = { #Fugandulu Vineyards
        icon = "task_political"
        requires = { 01_fugandulu_task_6 01_fugandulu_task_9 }

        highlight = {
            scope:province = {
                owner = root
                is_capital = yes
            }
        }

        allow = {
            civic_tech >= 2
            hidden:capital_scope = {
                has_building = workshop_building
                has_no_ongoing_construction = yes
            }
        }
        
        on_completion = {
            capital_scope = {
                create_state_pop = citizen
                create_state_pop = nobles
                add_permanent_province_modifier = {
                    name = sri_ksetra_vineyard_mod
                    duration = -1
                }
            }
            trigger_event = me_fugandulu.13
        }
    }
    01_fugandulu_task_14 = { #War Elephants Of Woe
        icon = "task_heracles"
        requires = { 01_fugandulu_task_4 01_fugandulu_task_5 } 

        highlight = {
			scope:province = {
				OR = {
                    province_id = 7349	
                    province_id = 7353	
                }
			}
		}

        allow = {
            owns = 7349
            owns = 7353
            hidden:p:7349 = {
                has_building = foundry_building
            }
            p:7353 = {
                has_building = latifundia_building
                total_population >= 13
            }
            military_tech >= 2
            invention = global_start_experience_inv_2
        }
        
        on_completion = {
            current_ruler = {
                force_add_trait = comradely
            }
            create_unit = {
                navy = no
                name = "War Elephants of Woe"
                location = capital_scope
                hidden_effect = {
                add_subunit = warelephant
                add_subunit = warelephant
                add_subunit = warelephant
                add_subunit = warelephant
                add_subunit = warelephant                                               
                add_subunit = warelephant
                add_subunit = warelephant
                add_food = 100
                add_morale = 2
                }
            }
            add_country_modifier = {
                name = fugadulu_jungle_elephants_mod
                duration = -1
            }
            trigger_event = me_fugandulu.14
            show_as_tooltip = {

            }
        }
    }
}