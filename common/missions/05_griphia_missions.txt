griphia_missions = {
    header = "mission_image_scythian"
    icon = "cde_gallic_village"

    repeatable = no

    chance = {
        factor = 50
    }

    potential = {
        NOT = { has_variable = griphia_missions_aborted }
        is_subject = no
        has_civil_war = no
		is_tribal = yes
		tag = SS4
    }

    abort = {
        ai_mission_back_out_trigger = yes
    }

    on_start = {
        start_mission_ai_effect = yes
		trigger_event = me_griphia.90
    }

    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = griphia_missions_aborted
            days = 7300
        }
    }

    griphia_missions_task_1 = { #Guarding Our Gold
        icon = "task_political"

		highlight = {
			scope:province = {
				is_in_area = gryphia_area
			}
        }

        allow = {
			OR = {
				any_owned_province = {
					count >= 2
					is_in_area = gryphia_area
					fort_level >= 1
				}
				any_owned_province = {
					is_in_area = gryphia_area
					fort_level >= 2
				}
			}
		}

        on_completion = {
            trigger_event = {
				id = me_griphia.1
				days = 180
			}
            show_as_tooltip = {
				p:12452 = {
					add_building_level = slave_mine_building
					create_state_pop = slaves
					create_state_pop = slaves
				}
				p:12455 = {
					add_building_level = slave_mine_building
					create_state_pop = slaves
					create_state_pop = slaves
				}
            }
			custom_tooltip = griphia_missions_task_1_claims
			hidden_effect = {
				area:jiankun_area = { mission_area_claim_effect = yes }
				area:ulangom_area = { mission_area_claim_effect = yes }
				c:XNU = {
					every_owned_province = {
						add_claim = root
					}
				}
			}
			p:10529 = {
				add_claim = root
			}
        }
    }

    griphia_missions_task_2 = { #At The Center Of Asia
        icon = "task_political"

        allow = {
			num_of_cities >= 25
			hidden:current_ruler = {
				has_triggered_character_modifier = command_focus_triggered_mod
			}
		}

        on_completion = {
            trigger_event = me_griphia.2
            custom_tooltip = griphia_missions_task_2_claims
			hidden_effect = {
				area:baraba_area = { mission_area_claim_effect = yes }
				area:irmen_area = { mission_area_claim_effect = yes }
				area:korgantas_area = { mission_area_claim_effect = yes }
				area:busu_area = { mission_area_claim_effect = yes }
				area:akmola_area = { mission_area_claim_effect = yes }
			}
        }
    }

    griphia_missions_task_3 = { #Return Of The Guardians
        icon = "task_political"
		requires = { griphia_missions_task_1 }

        allow = {
			any_owned_province = {
				is_in_area = gryphia_area
				is_holy_site = yes
				province_has_special_pop = {
					text = "prov_has_1_priest_tt"
					type = priest
					count = 1
				}
			}
		}

        on_completion = {
            trigger_event = me_griphia.3
            show_as_tooltip = {
				create_country_treasure = {
					key = "golden_griphon_gryphia"
					icon = "treasure_chest"
					modifier = {
						local_defensive = 0.2
						local_pop_conversion_speed = 0.1
						local_tax_modifier = 0.2
					}
				}
            }
        }
    }

    griphia_missions_task_4 = { #Caravan To Tanais
        icon = "task_political"
		duration = 365

		highlight = {
			scope:province = {
				province_id = 4557
			}
        }

		bypass = {
			owns = 4557
		}

        allow = {
			hidden:capital_scope = {
				province_has_special_pop = {
					text = "prov_has_1_merchant_tt"
					type = merchant
					count = 1
				}
			}
			treasury >= 50
			manpower >= 1
		}

		on_start = {
			add_manpower = -1
			add_treasury = -50
		}

        on_completion = {
			hidden_effect = {
				random_list = {
					80 = {
						trigger_event = me_griphia.4
					}
					20 = {
						trigger_event = me_griphia.400
					}
				}
			}
            custom_tooltip = griphia_missions_task_4_caravan_tt
        }
    }

    griphia_missions_task_5 = { #People Of Siberia
        icon = "task_political"
		requires = { griphia_missions_task_2 }

		highlight = {
			scope:province = {
				OR = {
					is_in_area = kulunda_area
					is_in_area = korgantas_area
					is_in_area = busu_area
					is_in_area = akmola_area
				}
			}
        }

        allow = {
			any_owned_province = {
				count >= 25
				OR = {
					is_in_area = kulunda_area
					is_in_area = korgantas_area
					is_in_area = busu_area
					is_in_area = akmola_area
				}
			}
		}

        on_completion = {
            trigger_event = me_griphia.5
			area:ili_area = { mission_area_claim_effect = yes }
			show_as_tooltip = {
				add_manpower = 10
			}
        }
    }

    griphia_missions_task_6 = { #Revenge Against Arimaspia
        icon = "task_political"
		requires = { griphia_missions_task_1 griphia_missions_task_2 }

		highlight = {
			scope:province = {
				owned_or_subject_owned = c:SS2
			}
        }

        allow = {
			trigger_if = {
				limit = {
					c:SS2 = {
						has_land = yes
					}
				}
				c:SS2 = {
					num_of_cities <= 20
				}
				c:SS2 = {
					has_opinion = {
						modifier = opinion_insult
						target = ROOT
					}
				}
			}
			trigger_else = {
				c:SS2 = {
					has_land = no
				}
			}
		}

        on_completion = {
            trigger_event = me_griphia.6
			custom_tooltip = griphia_missions_task_6_claims
			hidden_effect = {
				area:magyarok_area = { mission_area_claim_effect = yes }
				area:itkul_area = { mission_area_claim_effect = yes }
				area:ingala_area = { mission_area_claim_effect = yes }
			}
            show_as_tooltip = {
				add_military_experience = 20
				add_country_modifier = {
					name = "crushed_arimaspia_as_gryphs"
					duration = 7300
				}
            }
        }
    }

    griphia_missions_task_7 = { #Eastern Threats
        icon = "task_political"
		requires = { griphia_missions_task_1 }

		highlight = {
			scope:province = {
				OR = {
					is_in_area = jiankun_area
					province_id = 10529
					owned_or_subject_owned = c:XNU
				}
			}
        }

        allow = {
			c:XNU = {
				has_land = no
			}
			owns_area = jiankun_area
			owns = 10529
		}

        on_completion = {
            trigger_event = me_griphia.7
            show_as_tooltip = {
				add_military_experience = 10
				add_political_influence = 60
            }
        }
    }

    griphia_missions_task_8 = { #Establish New Trade Routes
        icon = "task_political"
		requires = { griphia_missions_task_4 }

        allow = {
			capital_scope = {
				has_building = commerce_building
			}
			capital_scope.state = {
				incoming_trade_routes >= 4
			}
		}

        on_completion = {
            trigger_event = me_griphia.8
			custom_tooltip = griphia_missions_task_8_claims
			hidden_effect = {
				area:upper_uralia_area = { mission_area_claim_effect = yes }
				area:aktobe_area = { mission_area_claim_effect = yes }
				area:atyrau_area = { mission_area_claim_effect = yes }
				area:darn_area = { mission_area_claim_effect = yes }
			}
            show_as_tooltip = {
				capital_scope = {
					add_province_modifier = {
						name = gryphia_new_trade
						duration = -1
					}
				}
            }
        }
    }

    griphia_missions_task_9 = { #Land Of The Seven Rivers
        icon = "task_political"
		requires = { griphia_missions_task_5 }

		highlight = {
			scope:province = {
				is_in_area = ili_area
			}
        }

        allow = {
			custom_tooltip = {
				text = griphia_missions_task_9_farms
				any_owned_province = {
					count >= 2
					is_in_area = ili_area
					has_building = basic_settlement_infratructure_building
				}
			}
			custom_tooltip = {
				text = griphia_missions_task_9_pastures
				any_owned_province = {
					count >= 2
					is_in_area = ili_area
					has_building = tribal_pastures_building
				}
			}
		}

        on_completion = {
            trigger_event = me_griphia.9
            custom_tooltip = griphia_missions_task_9_claims
			hidden_effect = {
				area:jaxartia_area = { mission_area_claim_effect = yes }
				area:ferghana_area = { mission_area_claim_effect = yes }
				area:sirdarya_area = { mission_area_claim_effect = yes }
				area:kapchagay_area = { mission_area_claim_effect = yes }
				area:chu_area = { mission_area_claim_effect = yes }
				area:taraz_area = { mission_area_claim_effect = yes }
			}
        }
    }

    griphia_missions_task_10 = { #Unifcation Of Uralia
        icon = "task_political"
		requires = { griphia_missions_task_5 griphia_missions_task_6 }

		highlight = {
			scope:province = {
				is_in_region = scytho_siberian_region
			}
        }

        allow = {
			any_owned_province = {
				count >= 100
				custom_tooltip = {
					text = is_in_region_scytho_siberian_region
					is_in_region = scytho_siberian_region
				}
			}
		}

        on_completion = {
            trigger_event = me_griphia.10
            show_as_tooltip = {
				add_country_modifier = {
					name = "unified_uralia_as_gryphs"
					duration = 7300
				}
				while = {
                    count = 10
					random_owned_province = {
						limit = {
							is_in_region = scytho_siberian_region
						}
						create_state_pop = freemen
						create_state_pop = freemen
					}
				}
            }
        }
    }

    griphia_missions_task_11 = { #Between A Rock And A Watery Place
        icon = "task_political"
		requires = { griphia_missions_task_5 griphia_missions_task_8 }

		highlight = {
			scope:province = {
				OR = {
					is_in_area = upper_uralia_area
					is_in_area = aktobe_area
					is_in_area = atyrau_area
					is_in_area = darn_area
				}
			}
        }

        allow = {
			any_owned_province = {
				count >= 20
				OR = {
					is_in_area = upper_uralia_area
					is_in_area = aktobe_area
					is_in_area = atyrau_area
					is_in_area = darn_area
				}
			}
		}

        on_completion = {
            trigger_event = me_griphia.11
            custom_tooltip = griphia_missions_task_11_claims
			hidden_effect = {
				area:atara_area = { mission_area_claim_effect = yes }
				area:alania_orientalis_area = { mission_area_claim_effect = yes }
				area:alania_proper_area = { mission_area_claim_effect = yes }
				area:confluenta_area = { mission_area_claim_effect = yes }
				area:tanassa_area = { mission_area_claim_effect = yes }
				area:maeotia_area = { mission_area_claim_effect = yes }
			}
        }
    }

    griphia_missions_task_12 = { #Into Persia
        icon = "task_political"
		requires = { griphia_missions_task_9 griphia_missions_task_10 }

		highlight = {
			scope:province = {
				OR = {
					is_in_area = jaxartia_area
					is_in_area = ferghana_area
					is_in_area = sirdarya_area
					is_in_area = kapchagay_area
					is_in_area = chu_area
					is_in_area = taraz_area
				}
			}
        }

        allow = {
			owns_or_subject_owns_area = jaxartia_area
			owns_or_subject_owns_area = ferghana_area
			owns_or_subject_owns_area = sirdarya_area
			owns_or_subject_owns_area = kapchagay_area
			owns_or_subject_owns_area = chu_area
			owns_or_subject_owns_area = taraz_area
		}

        on_completion = {
            trigger_event = me_griphia.12
            custom_tooltip = griphia_missions_task_12_claims
			hidden_effect = {
				area:oxiana_area = { mission_area_claim_effect = yes }
				area:bactria_area = { mission_area_claim_effect = yes }
				area:candara_area = { mission_area_claim_effect = yes }
				area:margu_area = { mission_area_claim_effect = yes }
				area:aria_area = { mission_area_claim_effect = yes }
				area:sogdiana_area = { mission_area_claim_effect = yes }
				area:transoxus_area = { mission_area_claim_effect = yes }
			}
        }
    }

    griphia_missions_task_13 = { #The Long Trade Route
        icon = "task_political"
		requires = { griphia_missions_task_11 }

		highlight = {
			scope:province = {
				OR = {
					is_in_area = atara_area
					is_in_area = alania_orientalis_area
					is_in_area = alania_proper_area
					is_in_area = confluenta_area
					is_in_area = tanassa_area
					province_id = 4557
				}
			}
        }

        allow = {
			owns = 4557
			owns_area = atara_area
			owns_area = alania_orientalis_area
			owns_area = alania_proper_area
			owns_area = confluenta_area
			owns_area = tanassa_area
		}

        on_completion = {
            trigger_event = me_griphia.13
			custom_tooltip = griphia_missions_task_13_claims
			hidden_effect = {
				region:taurica_region = {
					every_region_province = {
						add_claim = root
					}
				}
			}
            show_as_tooltip = {
				add_country_modifier = {
					name = gryphia_trade_route
					duration = -1
				}
            }
        }
    }

    griphia_missions_task_14 = { #Raid Persia
        icon = "task_political"
		requires = { griphia_missions_task_12 }

		highlight = {
			scope:province = {
				OR = {
					is_in_area = oxiana_area
					is_in_area = bactria_area
					is_in_area = candara_area
					is_in_area = margiana_area
					is_in_area = margu_area
					is_in_area = aria_area
					is_in_area = sogdiana_area
					is_in_area = transoxus_area
				}
			}
        }

        allow = {
			owns_or_subject_owns_area = oxiana_area
			owns_or_subject_owns_area = bactria_area
			owns_or_subject_owns_area = candara_area
			owns_or_subject_owns_area = margiana_area
			owns_or_subject_owns_area = margu_area
			owns_or_subject_owns_area = aria_area
			owns_or_subject_owns_area = sogdiana_area
			owns_or_subject_owns_area = transoxus_area
		}

        on_completion = {
            trigger_event = me_griphia.14
			show_as_tooltip = {
				add_splendor = {
					amount = "300"
				}
			}
			custom_tooltip = griphia_missions_task_14_claims
            hidden_effect = {
				region:ariana_region = {
					every_region_province = {
						add_claim = root
					}
				}
				region:persis_region = {
					every_region_province = {
						add_claim = root
					}
				}
			}
        }
    }

    griphia_missions_task_15 = { #Envoys To Delos
        icon = "task_political"
		requires = { griphia_missions_task_13 }
		duration = 365

		bypass = {
			owns = 1835
		}

		highlight = {
			scope:province = {
				province_id = 1835
			}
        }

        allow = {
			treasury >= 200
		}

		on_start = {
			add_treasury = -200
			if = {
				limit = {
					p:1835 = {
						has_owner = yes
					}
				}
				p:1835 = {
					owner = {
						trigger_event = {
							id = me_griphia.1500
							days = 180
						}
					}
				}
			}
		}

        on_completion = {
            trigger_event = me_griphia.15
			custom_tooltip = griphia_missions_task_15_improved_relations
            show_as_tooltip = {
				add_innovation = 2
            }
        }
    }

    griphia_missions_task_16 = { #The Legendary Gryphons
        icon = "task_political"
		requires = { griphia_missions_task_12 griphia_missions_task_13 }
		final = yes

        allow = {
			treasury >= 5000
			num_of_cities >= 200
		}

        on_completion = {
            trigger_event = me_griphia.16
            show_as_tooltip = {
				add_country_modifier = {
					name = golden_gryphons
					duration = -1
				}
            }
        }
    }
}
