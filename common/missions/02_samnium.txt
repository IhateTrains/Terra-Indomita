samnium_mission = { # Mission for Samnium
	icon = rome_1
	header = mission_image_rome
	
	repeatable = no

    chance = {
		factor = 10
	}
	
	ai_chance = { factor = 10 }

	potential = { 
		tag = SAM
		NOT = {
			has_variable = samnium_mission_cooldown
		}
	}
	
	abort = {
        ai_mission_back_out_trigger = yes
    }

    on_potential = {}

    on_start = {
    	start_mission_ai_effect = yes
    }

    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = samnium_mission_cooldown
            days = 7300
        }
    }

    on_completion = {
    	complete_mission_effect = yes
		add_2_free_province_investments = yes
    }

	samnium_task_1 = {
		icon = "task_political"
        highlight = {
            scope:province = {
                OR = {
                    owner = c:SPA
                    owner = c:APU
                    owner = c:MSP
                    owner = c:LCA
                    owner = c:TAR
                }
            }
        }
        allow = {
            custom_tooltip = {
				text = samnium_doesn_fight_303_tt
				OR = {
					has_global_variable = lucania_lost_war
					has_global_variable = tarentum_lost_war
					has_variable = samnium_doesn't_fight_var
				}
			}
        }

		on_completion = {
			trigger_event = { id = samnium_event.1 }
			show_as_tooltip = {
				if = {
					limit = {
						has_global_variable = lucania_lost_war
					}
					add_country_modifer = {
						name = samnium_war_lost_recovery
						duration = 1825 # 5 years
					}
				}
				else_if = {
					limit = {
						has_global_variable = tarentum_lost_war
					}
					add_political_influence = 25
					add_treasury = 250
					current_ruler = {
						add_martial = 1
						add_popularity = 5
					}
				}
				else_if = {
					limit = {
						has_variable = samnium_doesn't_fight_var
					}
					add_political_influence = 50
					current_ruler = {
						add_charisma = 1
						add_popularity = 5
					}
				}
				else = { # fallback, although not really necessary. you never knoe though what those players will cook up
					add_political_influence = 50
				}
			}
		}
	}

	samnium_task_2 = { # get allies
		icon = "task_political"
        allow = {
            calc_true_if = {
				amount >= 2
				any_country = {
					alliance_with = root
				}
			}
        }

		on_completion = {
			trigger_event = { id = samnium_event.2 }
			show_as_tooltip = {
				add_political_influence = 50
				add_treasury = 150
				capital_scope = {
					define_pop = {
						culture = etrurian
						religion = italic_pantheon
						type = freemen
					}
					define_pop = {
						culture = umbrian
						religion = italic_pantheon
						type = freemen
					}
				}
			}
		}
	}

	samnium_task_3 = { # prepare for war
		icon = "task_political"
        allow = {
            manpower >= 2
        }

		on_completion = {
			trigger_event = { id = samnium_event.3 }
			show_as_tooltip = {
				add_manpower = 5
				add_country_modifier = {
					name = temporary_levy_size_samnium
					duration = 1825 # 5 years
				}
			}
		}
	}

	samnium_task_4 = { # sabotage - bigger event chain. maybe borrow vanilla spy events?
		icon = "task_political"
        allow = {
            political_influence >= 10
        }

		on_completion = {
			trigger_event = { id = samnium_event.4 }
			custom_tooltip = sam_rom_spy_tt
		}
	}

	samnium_task_5 = { # third samnite war
		icon = "task_political"
        allow = {
            war_with = c:ROM
        }

		requires = { samnium_task_2 samnium_task_3 samnium_task_4 }

		on_completion = {
			trigger_event = { id = samnium_event.5 }
			show_as_tooltip = {
				add_military_experience = 25
			}
		}
	}

	samnium_task_6 = { # peace after war
		icon = "task_political"
        allow = {
            war = no
			has_civil_war = no
        }

		requires = { samnium_task_1 samnium_task_5 }

		on_completion = {
			trigger_event = { id = samnium_event.6 }
			show_as_tooltip = {
				add_country_modifier = {
					name = war_aftermath_samnium
					duration = 3650
				}
			}
		}
	}
}
