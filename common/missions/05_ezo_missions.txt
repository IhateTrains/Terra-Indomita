ezo_missions = {
    header = "mission_image_japan"
    icon = "cde_tribal_raid"

    repeatable = no
    chance = 1000

    potential = {
        NOT = { has_variable = mission_cooldown_var }
        primary_culture = ainu
    }

    abort = {}
    on_start = {
        start_mission_ai_effect = yes
    }
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }
    on_completion = {}

    ezo_missions_task_1 = { # Horizons of Hokkaido
        icon = "task_diplomatic"
        duration = 30
        requires = {}
        allow = {
            trigger_if = {
                limit = {
                    tag = ESN
                }
                political_influence >= 10
                num_of_ships >= 5
            }
            trigger_else = {
                political_influence >= 25
                treasury >= 25
            }
        }
        on_completion = {
            if = {
                limit = {
                    tag = ESN
                }
                trigger_event = me_jomon.1
            }
            else = {
                trigger_event = me_jomon.101
            }
            show_as_tooltip = {
                if = {
                    limit = {
                        tag = ESN
                    }
                    custom_tooltip = claims_on_sunazawa_tt
                }
                else = {
                    custom_tooltip = claims_on_sakhalin_tt
                }
            }
        }
    }

    ezo_missions_task_2 = { # The Three Tribes
        icon = "task_conquest"
        highlight = {
            scope:province = {
                OR = {
                    owner = c:ESN
                    owner = c:ESU
                    owner = c:KTM
                }
            }
        }
        allow = {
            custom_tooltip = {
                any_country = {
                    primary_culture = ainu
                    NOT = { this = root }
                    opinion = {
                        target = root 
                        value >= 125            
                    }
                }
                text = "hokkaido_opinion_tt"
            }
        }
        bypass = {
            owns_or_subject_owns_area = hokkaido_area
        }
        on_completion = {
            trigger_event = me_jomon.2
            set_variable = hokkaido_unification_var
            show_as_tooltip = {
                custom_tooltip = hokkaido_unification_decision_tt
            }
        }
    }
    ezo_missions_task_3 = { # Proficient Fishing
        icon = "task_expansion"
        requires = { ezo_missions_task_2 }
        highlight = {
            scope:province = {
                OR = {
                    province_id = 10567
                    province_id = 10568
                    province_id = 10575
                }
            }
        }
        allow = {
            owns_or_subject_owns = 10567
            owns_or_subject_owns = 10568
            owns_or_subject_owns = 10575
            any_owned_province = {
                trade_goods = fish
                has_building = basic_settlement_infratructure_building
            }
        }
        on_completion = {
            trigger_event = me_jomon.3
            show_as_tooltip = {

            }
        }
    }
    ezo_missions_task_4 = { # Sap-Stone of Sakhalin
        icon = "task_economical"
        duration = 30
        requires = { ezo_missions_task_2 }
        highlight = {
            scope:province = {
                OR = {
                    province_id = 10569
                    province_id = 10570
                    province_id = 10571
                }
            }
        }
        allow = {
            owns_or_subject_owns = 10569
            owns_or_subject_owns = 10570
            owns_or_subject_owns = 10571
            OR = {
                p:10570 = {
                    has_building = commerce_building
                }
                p:10571 = {
                    has_building = commerce_building
                }
                p:10569 = {
                    has_building = commerce_building
                }
            }
            custom_tooltip = {
                any_country = {
                    tag = TU7
                    opinion = {
                        target = root 
                        value >= 75            
                    }
                }
                text = "susuya_opinion_tt"
            }
        }
        on_start = {
            trigger_event = me_jomon.401
        }
        on_completion = {
            trigger_event = me_jomon.4
            show_as_tooltip = {

            }
        }
    }
    ezo_missions_task_5 = { # Art of Amber
        icon = "task_political"
        requires = { ezo_missions_task_2 }
        highlight = {
            scope:province = {
                OR = {
                    province_id = 10572
                    province_id = 10573
                    province_id = 10574
                }
            }
        }
        allow = {
            owns_or_subject_owns = 10572
            owns_or_subject_owns = 10573
            owns_or_subject_owns = 10574
            OR = {
                custom_tooltip = {
                    capital_scope = {
                        is_importing_trade_good = amber
                        hidden:state = {
                            trade_good_imports = {
                                target = amber
                                value >= 2
                            }
                        }  
                    }
                    text = foreign_amber_tt
                }
                custom_tooltip = {
                    text = local_amber_tt
                    any_owned_province = {
                        trade_goods = amber
                        num_goods_produced >= 1
                    }
                }
            }
        }
        on_completion = {
            trigger_event = me_jomon.5
            show_as_tooltip = {
                create_country_treasure = {
                    key = amber_jewelry
                    icon = todo
                    modifier = {
                        local_goods_from_slaves = -4
                    }
                }
                p:10572 = {
                    add_permanent_province_modifier = {
                        name = hub_of_amber
                        duration = -1
                    }
                }
            }
        }
    }
    ezo_missions_task_6 = { # Hokkaido is Home
        icon = "task_happiness"
        requires = { ezo_missions_task_3 ezo_missions_task_4 ezo_missions_task_5 }
        highlight = {
            scope:province = {
                is_in_area = hokkaido_area
            }
        }
        allow = {
            owns_or_subject_owns_area = hokkaido_area
        }
        on_completion = {
            trigger_event = me_jomon.6
            show_as_tooltip = {

            }
        }
        final = yes
    }

    ## ESAN
    ezo_missions_task_7 = { # Sunazawa Siblings
        icon = "task_religion"
        potential = { tag = ESN }
        requires = { ezo_missions_task_1 }
        highlight = {
            scope:province = {
                OR = {
                    province_id = 10558
                    province_id = 10559
                    province_id = 10560
                    province_id = 10562
                }
            }
        }
        allow = {
            owns_or_subject_owns = 10558
            owns_or_subject_owns = 10559
            owns_or_subject_owns = 10560
            owns_or_subject_owns = 10562
            custom_tooltip = {
                any_integrated_culture = {
                    is_culture = sunazawa
                }
                text = "esan_mixed_culture"
            }
        }
        on_completion = {
            trigger_event = me_jomon.7
            show_as_tooltip = {

            }
        }
    }

    ## EBETSU-KITAMI
    ezo_missions_task_8 = { # Susuya Siblings
        icon = "task_religion"
        potential = {
            OR = {
                tag = KTM
                tag = ESU
            }
        }
        requires = { ezo_missions_task_1 }
        allow = {
            custom_tooltip = {
                any_country = {
                    tag = TU7
                    opinion = {
                        target = root 
                        value >= 180            
                    }
                }
                text = "susuya_opinion_2_tt"
            } 
        }
        on_completion = {
            trigger_event = me_jomon.8
            show_as_tooltip = {

            }
        }
    }
    ezo_missions_task_9 = { # Playground of the Gods
        icon = "task_atlas"
        requires = { ezo_missions_task_1 }
        highlight = {
            scope:province = {
                province_id = 8114
            }
        }
        allow = {
            owns_or_subject_owns_area = hokkaido_area
            custom_tooltip = {
                text = playground_of_the_gods_tt
                p:5993 = {
                    OR = {
                        NOR = { 
                            has_province_modifier = generic_barbarian_spawn_place
                            has_province_modifier = minor_barbarian_spawn_place
                            has_province_modifier = major_barbarian_spawn_place
                        }
                        any_neighbor_province = {
                            count >= 2
                            civilization_value >= 30
                        }
                    }
                }
            }
        }
        on_completion = {
            trigger_event = me_jomon.9
            show_as_tooltip = {

            }
        }
    }
    ezo_missions_task_10 = { # Oshima Shallow Forts
        icon = "task_battle"
        highlight = {
            scope:province = {
                province_id = 10567
            }
        }
        potential = { tag = ESN }
        requires = { ezo_missions_task_3 }
        allow = {}
        on_completion = {
            trigger_event = me_jomon.10
            show_as_tooltip = {
    
            }
        }
    }
    ezo_missions_task_11 = { # Ishikari Animal Humor
        icon = "task_battle"
        highlight = {
            scope:province = {
                province_id = 10569
            }
        }
        potential = { tag = ESU }
        requires = { ezo_missions_task_4 }
        allow = {}
        on_completion = {
            trigger_event = me_jomon.11
            show_as_tooltip = {
    
            }
        }
    }
    ezo_missions_task_12 = { # Okhotsk Scallop Farming
        icon = "task_battle"
        highlight = {
            scope:province = {
                province_id = 10572
            }
        }
        potential = { tag = KTM }
        requires = { ezo_missions_task_5 }
        allow = {}
        on_completion = {
            trigger_event = me_jomon.12
            show_as_tooltip = {
    
            }
        }
    }
    ezo_missions_task_13 = {
        icon = "task_political"
        potential = {
            OR = {
                tag = KTM
                tag = ESU
            }
        }
        requires = { ezo_missions_task_9 ezo_missions_task_8 }
        allow = {}
        on_completion = {
            trigger_event = me_jomon.13
            show_as_tooltip = {
    
            }
        }
    }
    ezo_missions_task_14 = {
        icon = "task_political"
        potential = { tag = ESN }
        requires = { ezo_missions_task_9 ezo_missions_task_7 }
        allow = {}
        on_completion = {
            trigger_event = me_jomon.14
            show_as_tooltip = {
    
            }
        }
    }
    ezo_missions_task_15 = {
        icon = "task_political"
        allow = {}
        requires = { ezo_missions_task_14 ezo_missions_task_13 ezo_missions_task_6 }
        on_completion = {
            trigger_event = me_jomon.15
            show_as_tooltip = {
    
            }
        }
    }
    #ezo_missions_task_16 = {
    #    icon = "task_political"
    #    allow = {}
    #    on_completion = {
    #        trigger_event = me_jomon.16
    #        show_as_tooltip = {
#
    #        }
    #    }
    #}
    #ezo_missions_task_17 = {
    #    icon = "task_political"
    #    allow = {}
    #    on_completion = {
    #        trigger_event = me_jomon.17
    #        show_as_tooltip = {
#
    #        }
    #    }
    #}
    #ezo_missions_task_18 = {
    #    icon = "task_political"
    #    allow = {}
    #    on_completion = {
    #        trigger_event = me_jomon.18
    #        show_as_tooltip = {
#
    #        }
    #    }
    #}
    #ezo_missions_task_19 = {
    #    icon = "task_political"
    #    allow = {}
    #    on_completion = {
    #        trigger_event = me_jomon.19
    #        show_as_tooltip = {
#
    #        }
    #    }
    #}
    #ezo_missions_task_20 = {
    #    icon = "task_political"
    #    allow = {}
    #    on_completion = {
    #        trigger_event = me_jomon.20
    #        show_as_tooltip = {
#
    #        }
    #    }
    #}
}