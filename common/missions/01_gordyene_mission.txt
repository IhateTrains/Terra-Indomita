01_gordyene = {
    header = "mission_image_general"
    icon = cde_new_city_founded

    repeatable = no
    chance = 1000

    potential = {
        tag = CRD
        NOT = { has_variable = mission_cooldown_var }
    }

    abort = {}
    on_start = {
        start_mission_ai_effect = yes
        set_variable = albania_properity_counting #Used for Generic Svalues !!!!!!!!!!!!! CHANGE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    }
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }
    on_completion = {}
    
    01_gordyene_task_1 = { # An Unruly People
        icon = "task_diplomatic"

        allow = {                                 
            # Maybe: is independent from Armenia? Or has disloyalty as vassal?
            idea = idea_martial_ethos
            invention = global_cohort_recruit_speed_inv
            has_law = coin_minting_law
            has_high_economic_policy = expense_army
            job_holder:office_warchief = { # Warchief
                loyalty >= 65
                martial >= 8 
            }
            opinion = {
                target = c:ARM
                value <= 0
            }
            c:ARM = {
                opinion = {
                    target = root
                    value <= 0
                }
            }
        }

        highlight = {
	
		}

        on_completion = {   # modifiers go in 00_from_missions_gordyene.txt
            custom_tooltip = 01_gordyene_mission_task_1_tooltip
            area:vaspurakan_area = {
                every_area_province = {
                    limit = {
                        exists = owner
                        NOT = { owner = c:ARM }
                    }
                    add_claim = c:ARM
                }
            }
            area:vaspurakan_area = {
                add_provincial_claim_effect = yes
            }
            add_military_experience = 50
            add_innovation = 2
            trigger_event = {
                id = me_gordyene.1
                # MAYBE: To break away from Armenia, this triggers an event where an Armenian border army appears in your territory 
                # and/or an army appears in Balesh (p:846) and you have to fight just that/those army/armies to break away.
            }
        }
    }

    01_gordyene_task_2 = { # Fortifying the Mountains of Qardu
        icon = "task_heracles"
        
        requires = { 01_gordyene_task_1 }

        allow = {                                 
            calc_true_if = {
                amount >= 1
                hidden:p:992 = {
                    has_building = fortress_building
                }
                hidden:p:992.state = {
                    has_state_modifier = state_improvement_military
                }
            }
            calc_true_if = {
                amount >= 2
                hidden:p:869 = {
                    has_building = fortress_building
                }
                hidden:p:834 = {
                    has_building = fortress_building
                }
                hidden:p:869.state = {
                    has_state_modifier = state_improvement_military
                }
            }
            invention = global_defensive_inv_2
        }

        highlight = {
            scope:province = {
				OR = {
                    province_id = 834
                    province_id = 869
                    province_id = 992
				}
			}
		}

        on_completion = {
            p:992 = {
                add_permanent_province_modifier = {
                    name = qardu_mountain_defense
                }
            }
            p:869 = {
                add_permanent_province_modifier = {
                    name = qardu_mountain_defense
                }
            }
            p:834 = {
                add_permanent_province_modifier = {
                    name = qardu_mountain_defense
                }
            }
            add_2_free_province_investments = yes
            trigger_event = {
                id = me_gordyene.2
            }
        }
    }

    01_gordyene_task_3 = { # Raiding the Seleukids
        icon = "task_battle"
       
        requires = { 01_gordyene_task_1 }
       
        allow = {                                 
            is_subject = no
            war = no
        }

        highlight = {
	
		}

        on_completion = {
            area:corduene_area = {
                add_provincial_claim_effect = yes
            }
            area:upper_mesopotamia_area = {
                add_provincial_claim_effect = yes
            }
            area:niniveh_area = {
                add_provincial_claim_effect = yes
            }
            add_innovation = 4
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_4 = { # Consolidating the Upper Tigris
        icon = "task_expansion"
        
        requires = { 01_gordyene_task_2 01_gordyene_task_3 }
        
        allow = {                                 
            owns_or_subject_owns_area = corduene_area
            owns_or_subject_owns_area = upper_mesopotamia_area
            owns_or_subject_owns_area = niniveh_area
            area:corduene_area = { # CUSTOM LOC !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
                any_area_province = {
                    count > 3
                    owner = root
                    has_city_status = yes
                }
            }
            area:upper_mesopotamia_area = {
                any_area_province = {
                    count > 3
                    owner = root
                    has_city_status = yes
                }
            }
            area:niniveh_area = {
                any_area_province = {
                    count > 3
                    owner = root
                    has_city_status = yes
                }
            }
        }

        highlight = {
            scope:province = {
				OR = {
					is_in_area = corduene_area
					is_in_area = upper_mesopotamia_area
                    is_in_area = niniveh_area
				}
			}
		}

        on_completion = {
            ordered_owned_province = {
				limit = {
					has_city_status = yes
                    OR = {
                        is_in_area = corduene_area
                        is_in_area = upper_mesopotamia_area
                        is_in_area = niniveh_area
                    }
				}
				order_by = {
					value = 0
					add = population_cap
					subtract = total_population
				}
				check_range_bounds = no
				max = 2
				create_2_nobles_effect = yes
			}
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_5 = { # A Rival in Adiabene
        icon = "task_conquest"
        
        requires = { 01_gordyene_task_4 }
        
        allow = {                                 
            
        }

        highlight = {
	
		}

        on_completion = {
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_6 = { # Kingdom of Gordyene
        icon = "task_atlas"
        
        requires = { 01_gordyene_task_4 }

        prevented_by = { 01_gordyene_task_7 }

        final = yes
        
        allow = {                                 
            
        }

        highlight = {
	
		}

        on_completion = {
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_7 = { # A Hurrian Kingdom
        icon = "task_religion"
        
        requires = { 01_gordyene_task_4 }

        prevented_by = { 01_gordyene_task_6 }

        final = yes
        
        allow = {                                 
            
        }

        highlight = {
	
		}

        on_completion = {
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_8 = { # The Triple-Citadel City
        icon = "task_expansion"
        
        requires = { 01_gordyene_task_1 }
        
        allow = {                                 
            p:833 = {
                num_of_fortress_building >= 3
                num_of_fortress_ramparts_building = 1
            }
        }

        highlight = {
            scope:province = {
				OR = {
                    province_id = 833
				}
			}
		}

        on_completion = {
            add_political_influence = -65
            add_treasury = -200
            add_manpower = -10
            p:833 = {
                set_city_status = city_metropolis
                define_pop = {
                    type = nobles
                    religion = root.religion
                    culture = root.culture
                }
                define_pop = {
                    type = nobles
                    religion = root.religion
                    culture = root.culture
                }
                define_pop = {
                    type = citizen
                    religion = root.religion
                    culture = root.culture
                }
                define_pop = {
                    type = citizen
                    religion = root.religion
                    culture = root.culture
                }
                define_pop = {
                    type = citizen
                    religion = root.religion
                    culture = root.culture
                }
            }
            add_5_free_province_investments = yes
            # add a modifier increasing the local infrastructure limit
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_9 = { # The Master-Builders
        icon = "task_political"
        
        requires = { 01_gordyene_task_8 }
        
        allow = {                                 
            
        }

        highlight = {
	
		}

        on_completion = {
            add_3_free_province_investments = yes
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_10 = { # Sareisa and Satalka
        icon = "task_artemis"
        
        requires = { 01_gordyene_task_8 }
        
        allow = {                                 
            
        }

        highlight = {
            scope:province = {
				OR = {
                    province_id = 869
                    province_id = 834
				}
			}
		}

        on_completion = {
            add_political_influence = -80
            add_treasury = -200
            p:869 = {
                set_city_status = city
            }
            p:834 = {
                set_city_status = city
            }
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_11 = { # Crossroads of the Tigris
        icon = "task_economical"
        
        requires = { 01_gordyene_task_9 }
        
        allow = {                                 
            
        }

        highlight = {
	
		}

        on_completion = {
            add_2_free_province_investments = yes
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_12 = { # Karduchian Pasturelands
        icon = "task_calm"
        
        requires = { 01_gordyene_task_1 }
        
        allow = { 
            calc_true_if = {
                amount = 2
                p:986 = {
                    has_building = basic_settlement_infratructure_building
                    num_of_tribesmen >= 4
                }
                p:992 = {
                    has_building = basic_settlement_infratructure_building
                    num_of_tribesmen >= 4
                }
                p:867 = {
                    has_building = basic_settlement_infratructure_building
                    num_of_slaves >= 8
                }
            }   
            invention = technology_cost_inv_1                             
        }

        highlight = {
            scope:province = {
				OR = {
					province_id = 867
                    province_id = 986
                    province_id = 992
				}
			}
		}

        on_completion = {
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_13 = { # Aromatic Amomum
        icon = "task_zeus_cornucopia"
        
        requires = { 01_gordyene_task_12 }
        
        allow = {                                 
            hidden:p:843 = {
                OR = {
                    has_building = foundry_building
                    has_building = latifundia_building
                }  
            }
            p:843 = {
                num_of_slaves >= 11
            }
            hidden:p:843.state = {
                trade_good_surplus = {
                    target = spices
                    value >= 3
                }
            }
            calc_true_if = {
                amount = 3
                OR = {
                    p:843 = { has_road_towards = p:992 }
                    p:992 = { has_road_towards = p:846 }
                }
                p:843 = { has_road_towards = p:833 }
                p:843 = { has_road_towards = p:869 }
                p:843 = { has_road_towards = p:842 }
            } 
        }

        highlight = {
            scope:province = {
				OR = {
					province_id = 843
				}
			}
		}

        on_completion = {
            every_character = {
				limit = {
					has_tech_office = yes
				}
				add_finesse = 1
				add_gold = 150
			}
            add_research = {
                technology = oratory_tech
                value = 10
            }
            # Every neighboring country (at setup or current?) gets a +15 opinion modifier for the aromatic scents
            trigger_event = {
                id = me_gordyene.1
                # Event allows you to invest in making other nearby territories produce 'spices'
            }
        }
    }

    01_gordyene_task_14 = { # The Vineyards of Qardu
        icon = "task_apollo"
        
        requires = { 01_gordyene_task_12 }
        
        allow = {                                 
            hidden:p:869 = {
                OR = {
                    has_building = foundry_building
                    has_building = latifundia_building
                }  
            }
            p:869 = {
                num_of_slaves >= 10
                num_of_citizen >= 4
                num_of_nobles >= 2
            }
            hidden:p:869.state = {
                trade_good_surplus = {
                    target = wine
                    value >= 2
                }
            }
            invention = seeder_plough_inv
            civic_tech >= 4
        }

        highlight = {
            scope:province = {
				OR = {
					province_id = 869
				}
			}
		}

        on_completion = {
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }

    01_gordyene_task_15 = { # Mining Gagates
        icon = "task_economical"
        
        requires = { 01_gordyene_task_13 }
        
        allow = {                                 
            hidden:p:833 = {
                OR = {
                    has_building = foundry_building
                    has_building = slave_mine_building
                }  
            }
            p:833 = {
                num_of_slaves >= 14
            }
            hidden:p:833.state = {
                trade_good_surplus = {
                    target = gems
                    value >= 3
                }
            }
            invention = global_goods_from_slaves_inv
        }

        highlight = {
            scope:province = {
				OR = {
					province_id = 833
				}
			}
		}

        on_completion = {
            add_research = {
                technology = civic_tech
                value = 15
            }
            trigger_event = {
                id = me_gordyene.1
            }
        }
    }
}